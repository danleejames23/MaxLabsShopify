<!-- Cart Header -->
<div class="page-header" style="position: relative; padding: 35px 0; background: linear-gradient(180deg, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.85) 100%); overflow: hidden;">
  <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=1920&q=80') center/cover; opacity: 0.2;"></div>
  <div class="container" style="position: relative; z-index: 1; text-align: center;">
    <span style="display: inline-block; background: rgba(0, 255, 127, 0.12); color: #00FF7F; padding: 5px 14px; border-radius: 50px; font-size: 0.65rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 10px;">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 5px;">
        <circle cx="9" cy="21" r="1"></circle>
        <circle cx="20" cy="21" r="1"></circle>
        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
      </svg>
      {{ cart.item_count }} {% if cart.item_count == 1 %}Item{% else %}Items{% endif %}
    </span>
    <h1 class="page-title" style="font-size: 2.2rem; font-weight: 800; margin-bottom: 8px; background: linear-gradient(135deg, #fff 0%, #00FF7F 50%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Your Cart</h1>
  </div>
</div>

<div class="cart-page" style="padding: 30px 0 50px;">
  <div class="container">
    {% if cart.item_count > 0 %}
      
      <!-- Free Shipping Progress Bar -->
      {% assign free_shipping_threshold = 7500 %}
      {% assign remaining = free_shipping_threshold | minus: cart.total_price %}
      {% assign progress = cart.total_price | times: 100 | divided_by: free_shipping_threshold %}
      {% if progress > 100 %}{% assign progress = 100 %}{% endif %}
      
      <div style="background: var(--color-background-secondary); border: 1px solid var(--color-border); border-radius: 12px; padding: 20px; margin-bottom: 25px;">
        {% if cart.total_price >= free_shipping_threshold %}
          <div style="display: flex; align-items: center; justify-content: center; gap: 10px; color: var(--color-primary);">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            <span style="font-weight: 600;">You've unlocked FREE shipping!</span>
          </div>
        {% else %}
          <div style="text-align: center; margin-bottom: 12px;">
            <span style="color: var(--color-text-muted); font-size: 0.9rem;">Add <strong style="color: var(--color-primary);">{{ remaining | money }}</strong> more for FREE shipping</span>
          </div>
          <div style="background: rgba(255,255,255,0.1); border-radius: 50px; height: 8px; overflow: hidden;">
            <div style="background: linear-gradient(90deg, var(--color-primary), #00cc66); height: 100%; width: {{ progress }}%; border-radius: 50px; transition: width 0.3s ease;"></div>
          </div>
        {% endif %}
      </div>

      <div class="cart-layout" style="display: grid; grid-template-columns: 1fr 380px; gap: 30px; align-items: start;">
        
        <!-- Cart Items -->
        <div class="cart-items" style="background: var(--color-background-secondary); border: 1px solid var(--color-border); border-radius: 12px; overflow: hidden;">
          
          <!-- Cart Header -->
          <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 15px; padding: 15px 20px; background: rgba(0,0,0,0.3); border-bottom: 1px solid var(--color-border); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; color: var(--color-text-muted);">
            <span>Product</span>
            <span style="text-align: center;">Quantity</span>
            <span style="text-align: right;">Total</span>
            <span style="width: 30px;"></span>
          </div>
          
          {% for item in cart.items %}
            <div class="cart-item" style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 15px; padding: 20px; align-items: center; border-bottom: 1px solid var(--color-border);">
              
              <!-- Product Info -->
              <div style="display: flex; gap: 15px; align-items: center;">
                <div style="width: 80px; height: 80px; border-radius: 8px; overflow: hidden; flex-shrink: 0; background: rgba(0,0,0,0.2);">
                  {% if item.image %}
                    <img src="{{ item.image | image_url: width: 200 }}" alt="{{ item.title }}" style="width: 100%; height: 100%; object-fit: cover;">
                  {% else %}
                    <img src="https://images.unsplash.com/photo-1584308666744-24d5c474f2ae?w=200&q=80" alt="{{ item.title }}" style="width: 100%; height: 100%; object-fit: cover;">
                  {% endif %}
                </div>
                <div>
                  <h3 style="margin: 0 0 5px; font-size: 1rem;"><a href="{{ item.url }}" style="color: #fff; text-decoration: none;">{{ item.product.title }}</a></h3>
                  {% if item.variant.title != 'Default Title' %}
                    <p style="margin: 0 0 5px; color: var(--color-primary); font-size: 0.85rem;">{{ item.variant.title }}</p>
                  {% endif %}
                  <p style="margin: 0; color: var(--color-text-muted); font-size: 0.85rem;">{{ item.price | money }} each</p>
                </div>
              </div>
              
              <!-- Quantity -->
              <div style="display: flex; justify-content: center;">
                <div class="quantity-selector" style="display: flex; align-items: center; background: rgba(0,0,0,0.3); border-radius: 8px; overflow: hidden;">
                  <button type="button" style="width: 36px; height: 36px; border: none; background: transparent; color: #fff; cursor: pointer; font-size: 1.2rem;" onclick="updateCartItem('{{ item.key }}', {{ item.quantity | minus: 1 }})">−</button>
                  <input type="number" value="{{ item.quantity }}" min="1" style="width: 40px; height: 36px; border: none; background: transparent; color: #fff; text-align: center; font-size: 0.95rem;" onchange="updateCartItem('{{ item.key }}', this.value)">
                  <button type="button" style="width: 36px; height: 36px; border: none; background: transparent; color: #fff; cursor: pointer; font-size: 1.2rem;" onclick="updateCartItem('{{ item.key }}', {{ item.quantity | plus: 1 }})">+</button>
                </div>
              </div>
              
              <!-- Price -->
              <div style="text-align: right; font-weight: 600; color: #fff;">
                {{ item.line_price | money }}
              </div>
              
              <!-- Remove -->
              <button onclick="removeCartItem('{{ item.key }}')" aria-label="Remove item" style="width: 30px; height: 30px; border: none; background: transparent; color: var(--color-text-muted); cursor: pointer; display: flex; align-items: center; justify-content: center; border-radius: 6px; transition: all 0.2s;" onmouseover="this.style.background='rgba(255,0,0,0.2)'; this.style.color='#ff4444';" onmouseout="this.style.background='transparent'; this.style.color='var(--color-text-muted)';">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                </svg>
              </button>
            </div>
          {% endfor %}
          
          <!-- Continue Shopping -->
          <div style="padding: 15px 20px; text-align: center;">
            <a href="/collections/all" style="color: var(--color-primary); text-decoration: none; font-size: 0.9rem; display: inline-flex; align-items: center; gap: 8px;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
              Continue Shopping
            </a>
          </div>
        </div>
        
        <!-- Order Summary -->
        <div class="cart-summary" style="background: var(--color-background-secondary); border: 1px solid var(--color-border); border-radius: 12px; padding: 25px; position: sticky; top: 100px;">
          <h3 style="margin: 0 0 20px; font-size: 1.2rem; font-weight: 700;">Order Summary</h3>
          
          <div style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.95rem;">
            <span style="color: var(--color-text-muted);">Subtotal ({{ cart.item_count }} items)</span>
            <span>{{ cart.total_price | money }}</span>
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.95rem;">
            <span style="color: var(--color-text-muted);">Shipping</span>
            <span style="color: {% if cart.total_price >= 7500 %}var(--color-primary){% else %}var(--color-text-muted){% endif %};">
              {% if cart.total_price >= 7500 %}FREE{% else %}Calculated at checkout{% endif %}
            </span>
          </div>
          
          <div style="border-top: 1px solid var(--color-border); margin: 20px 0; padding-top: 20px; display: flex; justify-content: space-between; font-size: 1.1rem; font-weight: 700;">
            <span>Total</span>
            <span style="color: var(--color-primary);">{{ cart.total_price | money }}</span>
          </div>
          
          <form action="/checkout" method="post">
            <button type="submit" class="btn btn-primary" style="width: 100%; padding: 16px; font-size: 1rem; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
              </svg>
              Secure Checkout
            </button>
          </form>
          
          <!-- Trust Badges -->
          <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--color-border);">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div style="display: flex; align-items: center; gap: 8px; font-size: 0.75rem; color: var(--color-text-muted);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="2">
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                  <path d="M9 12l2 2 4-4"/>
                </svg>
                SSL Encrypted
              </div>
              <div style="display: flex; align-items: center; gap: 8px; font-size: 0.75rem; color: var(--color-text-muted);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="2">
                  <rect x="1" y="3" width="22" height="18" rx="2" ry="2"/>
                  <line x1="1" y1="9" x2="23" y2="9"/>
                </svg>
                Secure Payment
              </div>
              <div style="display: flex; align-items: center; gap: 8px; font-size: 0.75rem; color: var(--color-text-muted);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                  <circle cx="12" cy="10" r="3"/>
                </svg>
                UK Shipping
              </div>
              <div style="display: flex; align-items: center; gap: 8px; font-size: 0.75rem; color: var(--color-text-muted);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
                30-Day Returns
              </div>
            </div>
          </div>
          
          <!-- Payment Methods -->
          <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--color-border);">
            <p style="font-size: 0.75rem; color: var(--color-text-muted); text-align: center; margin-bottom: 12px;">We Accept</p>
            <div style="display: flex; justify-content: center; gap: 8px; flex-wrap: wrap;">
              <svg width="36" height="22" viewBox="0 0 42 26" fill="none"><rect width="42" height="26" rx="4" fill="#1434CB"/><path d="M17.5 17L19 9H21L19.5 17H17.5Z" fill="#FFF"/><path d="M27 9.2C26.5 9 25.8 8.8 25 8.8C23 8.8 21.5 9.8 21.5 11.2C21.5 12.3 22.5 12.9 23.2 13.2C24 13.5 24.2 13.8 24.2 14.1C24.2 14.6 23.6 14.8 23 14.8C22.2 14.8 21.7 14.7 21 14.4L20.7 14.3L20.5 16C21 16.2 21.9 16.4 22.9 16.4C25 16.4 26.4 15.4 26.4 13.9C26.4 13 25.9 12.4 24.7 11.9C24 11.6 23.6 11.4 23.6 11C23.6 10.7 24 10.4 24.7 10.4C25.4 10.4 25.9 10.5 26.2 10.6L26.4 10.7L27 9.2Z" fill="#FFF"/><path d="M30.5 9H29C28.5 9 28.1 9.1 27.9 9.6L25 17H27.2L27.6 15.8H30.3L30.5 17H32.5L30.5 9ZM28.2 14.2C28.3 13.7 29 11.8 29 11.8L29.2 11.2L29.3 11.8C29.3 11.8 29.7 13.6 29.8 14.2H28.2Z" fill="#FFF"/><path d="M15.5 9L13.5 14.2L13.2 13C12.8 11.7 11.6 10.3 10.2 9.6L12 17H14.3L17.8 9H15.5Z" fill="#FFF"/><path d="M11.5 9H8.5V9.1C11 9.7 12.7 11.3 13.2 13L12.5 9.6C12.4 9.2 12 9 11.5 9Z" fill="#FAA61A"/></svg>
              <svg width="36" height="22" viewBox="0 0 42 26" fill="none"><rect width="42" height="26" rx="4" fill="#1A1F2E"/><circle cx="16" cy="13" r="7" fill="#EB001B"/><circle cx="26" cy="13" r="7" fill="#F79E1B"/><path d="M21 7.5C22.5 8.7 23.5 10.7 23.5 13C23.5 15.3 22.5 17.3 21 18.5C19.5 17.3 18.5 15.3 18.5 13C18.5 10.7 19.5 8.7 21 7.5Z" fill="#FF5F00"/></svg>
              <svg width="36" height="22" viewBox="0 0 42 26" fill="none"><rect width="42" height="26" rx="4" fill="#003087"/><path d="M15 7H18C20 7 21 8 20.8 9.5C20.5 11.5 19 13 17 13H16L15.5 16H13.5L15 7Z" fill="#FFF"/><path d="M17 9H18C18.6 9 19 9.3 18.9 9.9C18.7 10.7 18.2 11.2 17.4 11.2H16.6L17 9Z" fill="#003087"/><path d="M22 7H25C27 7 28 8 27.8 9.5C27.5 11.5 26 13 24 13H23L22.5 16H20.5L22 7Z" fill="#009CDE"/><path d="M24 9H25C25.6 9 26 9.3 25.9 9.9C25.7 10.7 25.2 11.2 24.4 11.2H23.6L24 9Z" fill="#003087"/></svg>
              <svg width="36" height="22" viewBox="0 0 42 26" fill="none"><rect width="42" height="26" rx="4" fill="#635BFF"/><path d="M19.5 11.2C19.5 10.6 20 10.3 20.8 10.3C22 10.3 23.4 10.7 24.6 11.3V8.2C23.3 7.7 22 7.5 20.8 7.5C17.8 7.5 16 9 16 11.4C16 15.2 21.2 14.6 21.2 16.2C21.2 16.9 20.6 17.2 19.7 17.2C18.4 17.2 16.8 16.6 15.5 15.9V19C16.9 19.6 18.4 19.8 19.7 19.8C22.8 19.8 24.7 18.4 24.7 16C24.7 11.9 19.5 12.6 19.5 11.2Z" fill="#FFF"/></svg>
            </div>
          </div>
        </div>
      </div>
      
    {% else %}
      
      <!-- Empty Cart -->
      <div style="text-align: center; padding: 60px 20px; max-width: 500px; margin: 0 auto;">
        <div style="width: 120px; height: 120px; background: rgba(0, 255, 127, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 30px;">
          <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="1.5">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
        </div>
        <h2 style="margin: 0 0 15px; font-size: 1.8rem; font-weight: 700;">Your cart is empty</h2>
        <p style="color: var(--color-text-muted); margin: 0 0 30px; font-size: 1rem;">Looks like you haven't added anything to your cart yet. Discover our premium supplements!</p>
        <a href="/collections/all" class="btn btn-primary" style="padding: 16px 40px; font-size: 1rem;">Start Shopping</a>
        
        <!-- Quick Links -->
        <div style="margin-top: 40px; padding-top: 30px; border-top: 1px solid var(--color-border);">
          <p style="color: var(--color-text-muted); font-size: 0.85rem; margin-bottom: 15px;">Popular Categories</p>
          <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
            <a href="/collections/all#raw" style="color: var(--color-primary); text-decoration: none; font-size: 0.9rem;">RAW Supplements</a>
            <span style="color: var(--color-border);">•</span>
            <a href="/collections/all#cycle" style="color: var(--color-primary); text-decoration: none; font-size: 0.9rem;">Cycle Support</a>
          </div>
        </div>
      </div>
      
    {% endif %}
  </div>
</div>

<style>
  @media (max-width: 900px) {
    .cart-layout {
      grid-template-columns: 1fr !important;
    }
    .cart-summary {
      position: static !important;
    }
    .cart-item {
      grid-template-columns: 1fr !important;
      gap: 15px !important;
    }
    .cart-item > div:first-child {
      grid-column: 1 / -1;
    }
    .cart-items > div:first-child {
      display: none !important;
    }
  }
</style>
