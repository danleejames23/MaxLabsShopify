<!DOCTYPE html>
<html class="no-js" lang="{{ request.locale.iso_code }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, height=device-height, minimum-scale=1.0">
  <meta name="theme-color" content="#000000">
  
  <title>
    {{ page_title }}{% if current_tags %} &ndash; tagged "{{ current_tags | join: ', ' }}"{% endif %}{% if current_page != 1 %} &ndash; Page {{ current_page }}{% endif %}{% unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless %}
  </title>

  {% if page_description %}
    <meta name="description" content="{{ page_description | escape }}">
  {% endif %}

  <link rel="canonical" href="{{ canonical_url }}">

  {% if settings.favicon != blank %}
    <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
  {% else %}
    <link rel="icon" type="image/jpeg" href="{{ 'favicon.jpg' | asset_url }}">
    <link rel="apple-touch-icon" href="{{ 'favicon.jpg' | asset_url }}">
  {% endif %}

  {% render 'meta-tags' %}
  
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  {{ 'base.css' | asset_url | stylesheet_tag }}
  {{ 'enhanced-styles.css' | asset_url | stylesheet_tag }}
  
  <script src="{{ 'global.js' | asset_url }}" defer></script>
  
  {{ content_for_header }}

  <style>
    :root {
      --color-primary: #00FF7F;
      --color-primary-dark: #00CC66;
      --color-secondary: #1a1a1a;
      --color-background: #000000;
      --color-background-secondary: #0d0d0d;
      --color-text: #ffffff;
      --color-text-muted: #a0a0a0;
      --color-border: #2a2a2a;
      --color-success: #00FF7F;
      --color-error: #ff4444;
      --font-heading: 'Orbitron', sans-serif;
      --font-body: 'Inter', sans-serif;
      --transition-fast: 0.2s ease;
      --transition-medium: 0.3s ease;
      --border-radius: 8px;
      --container-max: 1400px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--font-body);
      background-color: var(--color-background);
      color: var(--color-text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    button {
      cursor: pointer;
      font-family: inherit;
    }

    .container {
      max-width: var(--container-max);
      margin: 0 auto;
      padding: 0 20px;
    }

    .visually-hidden {
      position: absolute !important;
      overflow: hidden;
      width: 1px;
      height: 1px;
      margin: -1px;
      padding: 0;
      border: 0;
      clip: rect(0 0 0 0);
      word-wrap: normal !important;
    }

    /* Header Styles */
    .site-header {
      position: fixed;
      top: 38px; /* Account for announcement bar */
      left: 0;
      right: 0;
      z-index: 1000;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--color-border);
      transition: var(--transition-medium);
    }
    
    .site-header.scrolled {
      top: 0; /* Hide announcement bar effect when scrolled */
      background: rgba(0, 0, 0, 0.98);
    }

    .header-wrapper {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px 0;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      height: 70px;
      width: auto;
    }

    .header-logo-text {
      font-family: var(--font-heading);
      font-size: 1.8rem;
      font-weight: 800;
      letter-spacing: 2px;
      color: #fff;
      position: relative;
    }

    .header-logo-text::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--color-primary);
    }

    .header-nav {
      display: flex;
      align-items: center;
      gap: 35px;
    }

    .header-nav a {
      font-size: 0.9rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: var(--transition-fast);
      position: relative;
    }

    .header-nav a:hover {
      color: var(--color-primary);
    }

    .header-nav a::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--color-primary);
      transition: var(--transition-fast);
    }

    .header-nav a:hover::after {
      width: 100%;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .header-cart {
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: transparent;
      border: 2px solid var(--color-primary);
      color: var(--color-primary);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 0.85rem;
      border-radius: var(--border-radius);
      transition: var(--transition-fast);
    }

    .header-cart:hover {
      background: var(--color-primary);
      color: #000;
    }

    .cart-count {
      background: var(--color-primary);
      color: #000;
      font-size: 0.7rem;
      font-weight: 700;
      padding: 2px 6px;
      border-radius: 50%;
      min-width: 18px;
      text-align: center;
    }

    .header-cart:hover .cart-count {
      background: #000;
      color: var(--color-primary);
    }

    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: #fff;
      font-size: 1.5rem;
      padding: 10px;
    }

    /* Mobile Navigation */
    .mobile-nav {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.98);
      z-index: 999;
      padding: 100px 30px 30px;
      transform: translateX(-100%);
      transition: var(--transition-medium);
    }

    .mobile-nav.active {
      transform: translateX(0);
    }

    .mobile-nav a {
      display: block;
      padding: 15px 0;
      font-size: 1.2rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 2px;
      border-bottom: 1px solid var(--color-border);
    }

    .mobile-nav-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: #fff;
      font-size: 2rem;
    }

    /* Footer Styles */
    .site-footer {
      background: var(--color-background-secondary);
      border-top: 1px solid var(--color-border);
      padding: 60px 0 30px;
      margin-top: 40px;
    }

    .footer-grid {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr;
      gap: 60px;
      margin-bottom: 60px;
    }

    .footer-brand {
      max-width: 350px;
    }

    .footer-logo {
      font-family: var(--font-heading);
      font-size: 1.5rem;
      font-weight: 800;
      letter-spacing: 2px;
      margin-bottom: 20px;
      position: relative;
      display: inline-block;
    }

    .footer-logo::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--color-primary);
    }

    .footer-brand p {
      color: var(--color-text-muted);
      font-size: 0.95rem;
      margin-bottom: 25px;
    }

    .footer-social {
      display: flex;
      gap: 15px;
    }

    .footer-social a {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--color-border);
      border-radius: 50%;
      transition: var(--transition-fast);
    }

    .footer-social a:hover {
      background: var(--color-primary);
      color: #000;
    }

    .footer-column h4 {
      font-family: var(--font-heading);
      font-size: 0.9rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 25px;
      color: var(--color-primary);
    }

    .footer-column ul {
      list-style: none;
    }

    .footer-column li {
      margin-bottom: 12px;
    }

    .footer-column a {
      color: var(--color-text-muted);
      font-size: 0.9rem;
      transition: var(--transition-fast);
    }

    .footer-column a:hover {
      color: var(--color-primary);
    }

    .footer-bottom {
      border-top: 1px solid var(--color-border);
      padding-top: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
    }

    .footer-copyright {
      color: var(--color-text-muted);
      font-size: 0.85rem;
    }

    .footer-payments {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .footer-payments img {
      height: 30px;
      opacity: 0.7;
    }

    /* Main Content */
    main {
      padding-top: 138px; /* 38px announcement bar + 100px header */
      min-height: 60vh;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 15px 35px;
      font-size: 0.9rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-radius: var(--border-radius);
      transition: var(--transition-fast);
      border: none;
      cursor: pointer;
    }

    .btn-primary {
      background: var(--color-primary);
      color: #000;
    }

    .btn-primary:hover {
      background: var(--color-primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 255, 127, 0.3);
    }

    .btn-secondary {
      background: transparent;
      color: var(--color-primary);
      border: 2px solid var(--color-primary);
    }

    .btn-secondary:hover {
      background: var(--color-primary);
      color: #000;
    }

    .btn-large {
      padding: 18px 45px;
      font-size: 1rem;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .header-nav {
        display: none;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .mobile-nav {
        display: block;
      }

      .footer-grid {
        grid-template-columns: 1fr 1fr;
        gap: 40px;
      }
    }

    @media (max-width: 768px) {
      .header-logo-text {
        font-size: 1.4rem;
      }

      .footer-grid {
        grid-template-columns: 1fr;
        gap: 40px;
      }

      .footer-bottom {
        flex-direction: column;
        text-align: center;
      }
    }

    /* Age Verification Modal */
    .age-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .age-modal.show {
      display: flex;
    }

    .age-modal-content {
      background: var(--color-background-secondary);
      border: 2px solid var(--color-primary);
      border-radius: 16px;
      padding: 50px;
      max-width: 500px;
      text-align: center;
    }

    .age-modal-logo {
      font-family: var(--font-heading);
      font-size: 2rem;
      font-weight: 800;
      margin-bottom: 30px;
      position: relative;
      display: inline-block;
    }

    .age-modal-logo::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--color-primary);
    }

    .age-modal h2 {
      font-family: var(--font-heading);
      font-size: 1.5rem;
      margin-bottom: 15px;
    }

    .age-modal p {
      color: var(--color-text-muted);
      margin-bottom: 30px;
    }

    .age-modal-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .age-modal-buttons .btn {
      min-width: 150px;
    }

    .age-deny-btn {
      background: var(--color-border);
      color: var(--color-text-muted);
    }

    .age-deny-btn:hover {
      background: var(--color-error);
      color: #fff;
    }
  </style>
</head>

<body class="template-{{ template.name | handle }}{% if template.suffix %} template-{{ template.name }}-{{ template.suffix }}{% endif %}">
  
  <!-- Announcement Bar -->
  {% section 'announcement-bar' %}
  
  <!-- Age Verification Modal - Hidden by default, shown via JS if not verified -->
  <div class="age-modal" id="ageModal">
    <div class="age-modal-content">
      <img src="{{ 'logotransparent.png' | asset_url }}" alt="Max Labs" class="age-modal-logo" style="height: 60px; width: auto;">
      <h2>Age Verification Required</h2>
      <p>You must be 18 years or older to enter this site. By clicking "I'm 18+" you confirm that you are of legal age.</p>
      <div class="age-modal-buttons">
        <button class="btn age-deny-btn" onclick="denyAge()">Exit</button>
        <button class="btn btn-primary" onclick="confirmAge()">I'm 18+</button>
      </div>
    </div>
  </div>

  <!-- Skip to content -->
  <a class="visually-hidden skip-to-content-link" href="#MainContent">
    {{ 'accessibility.skip_to_content' | t }}
  </a>

  <!-- Header -->
  <header class="site-header" id="siteHeader">
    <div class="container">
      <div class="header-wrapper">
        <a href="/" class="header-logo">
          {% if settings.logo != blank %}
            <img src="{{ settings.logo | image_url: width: 200 }}" alt="{{ shop.name }}" loading="eager">
          {% else %}
            <img src="{{ 'logotransparent.png' | asset_url }}" alt="{{ shop.name }}" loading="eager" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';">
            <span class="header-logo-text" style="display:none;">MAX LABS</span>
          {% endif %}
        </a>

        <nav class="header-nav">
          <a href="/">Home</a>
          <a href="/collections/all">Shop</a>
          <a href="/pages/about-us">About</a>
          <a href="/pages/faq">FAQ</a>
          <a href="/blogs/news">Blog</a>
          <a href="/pages/bigboybaker">BigBoyBaker</a>
          <a href="/pages/contact">Contact</a>
        </nav>

        <div class="header-actions">
          <a href="/cart" class="header-cart">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            Cart
            <span class="cart-count">{{ cart.item_count }}</span>
          </a>
          
          <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Open menu">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Navigation -->
  <nav class="mobile-nav" id="mobileNav">
    <button class="mobile-nav-close" id="mobileNavClose" aria-label="Close menu">&times;</button>
    <a href="/">Home</a>
    <a href="/collections/all">Shop All</a>
    <a href="/pages/about-us">About Us</a>
    <a href="/pages/faq">FAQ</a>
    <a href="/blogs/news">Blog</a>
    <a href="/pages/bigboybaker">BigBoyBaker</a>
    <a href="/pages/contact">Contact</a>
    <a href="/cart">Cart ({{ cart.item_count }})</a>
  </nav>

  <!-- Main Content -->
  <main id="MainContent" role="main" tabindex="-1">
    {{ content_for_layout }}
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-brand">
          <div class="footer-logo">MAX LABS</div>
          <p>Premium science-backed supplements for peak performance. Trusted by athletes and fitness enthusiasts worldwide. Third-party tested for purity and potency.</p>
          <div class="footer-social">
            <a href="#" aria-label="Instagram">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
            </a>
            <a href="#" aria-label="Twitter">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
            </a>
            <a href="#" aria-label="Facebook">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
            </a>
            <a href="#" aria-label="YouTube">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
              </svg>
            </a>
          </div>
        </div>

        <div class="footer-column">
          <h4>Shop</h4>
          <ul>
            <li><a href="/collections/all">All Products</a></li>
            <li><a href="/collections/all#raw">RAW Supplements</a></li>
            <li><a href="/collections/all#cycle">Cycle Support & PCT</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h4>Support</h4>
          <ul>
            <li><a href="/pages/contact">Contact Us</a></li>
            <li><a href="/pages/faq">FAQ</a></li>
            <li><a href="/pages/shipping-delivery">Shipping Info</a></li>
            <li><a href="/pages/returns-refunds">Returns</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h4>Legal</h4>
          <ul>
            <li><a href="/pages/privacy-policy">Privacy Policy</a></li>
            <li><a href="/pages/terms-conditions">Terms & Conditions</a></li>
            <li><a href="/pages/returns-refunds">Refund Policy</a></li>
            <li><a href="/pages/shipping-delivery">Shipping Policy</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <p class="footer-copyright">&copy; {{ 'now' | date: '%Y' }} {{ shop.name }}. All rights reserved.</p>
        <div class="footer-payments">
          <!-- Visa -->
          <svg width="42" height="26" viewBox="0 0 42 26" fill="none">
            <rect width="42" height="26" rx="4" fill="#1434CB"/>
            <path d="M17.5 17L19 9H21L19.5 17H17.5Z" fill="#FFF"/>
            <path d="M27 9.2C26.5 9 25.8 8.8 25 8.8C23 8.8 21.5 9.8 21.5 11.2C21.5 12.3 22.5 12.9 23.2 13.2C24 13.5 24.2 13.8 24.2 14.1C24.2 14.6 23.6 14.8 23 14.8C22.2 14.8 21.7 14.7 21 14.4L20.7 14.3L20.5 16C21 16.2 21.9 16.4 22.9 16.4C25 16.4 26.4 15.4 26.4 13.9C26.4 13 25.9 12.4 24.7 11.9C24 11.6 23.6 11.4 23.6 11C23.6 10.7 24 10.4 24.7 10.4C25.4 10.4 25.9 10.5 26.2 10.6L26.4 10.7L27 9.2Z" fill="#FFF"/>
            <path d="M30.5 9H29C28.5 9 28.1 9.1 27.9 9.6L25 17H27.2L27.6 15.8H30.3L30.5 17H32.5L30.5 9ZM28.2 14.2C28.3 13.7 29 11.8 29 11.8L29.2 11.2L29.3 11.8C29.3 11.8 29.7 13.6 29.8 14.2H28.2Z" fill="#FFF"/>
            <path d="M15.5 9L13.5 14.2L13.2 13C12.8 11.7 11.6 10.3 10.2 9.6L12 17H14.3L17.8 9H15.5Z" fill="#FFF"/>
            <path d="M11.5 9H8.5V9.1C11 9.7 12.7 11.3 13.2 13L12.5 9.6C12.4 9.2 12 9 11.5 9Z" fill="#FAA61A"/>
          </svg>
          <!-- Mastercard -->
          <svg width="42" height="26" viewBox="0 0 42 26" fill="none">
            <rect width="42" height="26" rx="4" fill="#1A1F2E"/>
            <circle cx="16" cy="13" r="7" fill="#EB001B"/>
            <circle cx="26" cy="13" r="7" fill="#F79E1B"/>
            <path d="M21 7.5C22.5 8.7 23.5 10.7 23.5 13C23.5 15.3 22.5 17.3 21 18.5C19.5 17.3 18.5 15.3 18.5 13C18.5 10.7 19.5 8.7 21 7.5Z" fill="#FF5F00"/>
          </svg>
          <!-- PayPal -->
          <svg width="42" height="26" viewBox="0 0 42 26" fill="none">
            <rect width="42" height="26" rx="4" fill="#003087"/>
            <path d="M15 7H18C20 7 21 8 20.8 9.5C20.5 11.5 19 13 17 13H16L15.5 16H13.5L15 7Z" fill="#FFF"/>
            <path d="M17 9H18C18.6 9 19 9.3 18.9 9.9C18.7 10.7 18.2 11.2 17.4 11.2H16.6L17 9Z" fill="#003087"/>
            <path d="M22 7H25C27 7 28 8 27.8 9.5C27.5 11.5 26 13 24 13H23L22.5 16H20.5L22 7Z" fill="#009CDE"/>
            <path d="M24 9H25C25.6 9 26 9.3 25.9 9.9C25.7 10.7 25.2 11.2 24.4 11.2H23.6L24 9Z" fill="#003087"/>
          </svg>
          <!-- Stripe -->
          <svg width="42" height="26" viewBox="0 0 42 26" fill="none">
            <rect width="42" height="26" rx="4" fill="#635BFF"/>
            <path d="M19.5 11.2C19.5 10.6 20 10.3 20.8 10.3C22 10.3 23.4 10.7 24.6 11.3V8.2C23.3 7.7 22 7.5 20.8 7.5C17.8 7.5 16 9 16 11.4C16 15.2 21.2 14.6 21.2 16.2C21.2 16.9 20.6 17.2 19.7 17.2C18.4 17.2 16.8 16.6 15.5 15.9V19C16.9 19.6 18.4 19.8 19.7 19.8C22.8 19.8 24.7 18.4 24.7 16C24.7 11.9 19.5 12.6 19.5 11.2Z" fill="#FFF"/>
          </svg>
        </div>
      </div>
    </div>
  </footer>

  <!-- Tidio Live Chat - Replace YOUR_TIDIO_KEY with your actual key from tidio.com -->
  {% if settings.tidio_key != blank %}
    <script src="//code.tidio.co/{{ settings.tidio_key }}.js" async></script>
  {% else %}
    <!-- Premium Chat Widget -->
    <style>
      .chat-widget {
        position: fixed;
        bottom: 25px;
        right: 25px;
        z-index: 9999;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      }
      
      .chat-btn {
        width: 65px;
        height: 65px;
        border-radius: 50%;
        background: linear-gradient(135deg, #00FF7F 0%, #00CC66 100%);
        border: none;
        cursor: pointer;
        box-shadow: 0 8px 32px rgba(0, 255, 127, 0.4), 0 0 0 0 rgba(0, 255, 127, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        animation: chatPulse 2s infinite;
      }
      
      @keyframes chatPulse {
        0%, 100% { box-shadow: 0 8px 32px rgba(0, 255, 127, 0.4), 0 0 0 0 rgba(0, 255, 127, 0.4); }
        50% { box-shadow: 0 8px 32px rgba(0, 255, 127, 0.4), 0 0 0 12px rgba(0, 255, 127, 0); }
      }
      
      .chat-btn::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
        transform: rotate(45deg);
        transition: all 0.5s;
        opacity: 0;
      }
      
      .chat-btn:hover::before {
        animation: btnShine 0.6s ease;
      }
      
      @keyframes btnShine {
        0% { left: -50%; opacity: 1; }
        100% { left: 150%; opacity: 0; }
      }
      
      .chat-btn:hover {
        transform: scale(1.1) rotate(5deg);
        box-shadow: 0 12px 40px rgba(0, 255, 127, 0.5);
      }
      
      .chat-btn.active {
        animation: none;
        transform: scale(0.95);
      }
      
      .chat-btn svg {
        transition: all 0.3s ease;
      }
      
      .chat-btn.active .chat-icon { display: none; }
      .chat-btn.active .close-icon { display: block; }
      .chat-btn .close-icon { display: none; }
      
      .chat-btn.has-message {
        animation: chatPulse 2s infinite, glowRing 1.5s infinite;
      }
      
      @keyframes glowRing {
        0%, 100% { box-shadow: 0 8px 32px rgba(0, 255, 127, 0.4), 0 0 0 0 rgba(0, 255, 127, 0.6); }
        50% { box-shadow: 0 8px 32px rgba(0, 255, 127, 0.4), 0 0 0 8px rgba(0, 255, 127, 0); }
      }
      
      .chat-teaser {
        position: absolute;
        right: 75px;
        bottom: 12px;
        background: #1a1a1a;
        border: 1px solid rgba(0, 255, 127, 0.3);
        padding: 10px 16px;
        border-radius: 12px;
        border-bottom-right-radius: 4px;
        font-size: 0.85rem;
        color: #fff;
        white-space: nowrap;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
        animation: teaserSlide 0.4s ease, teaserFloat 3s ease-in-out infinite 0.4s;
        cursor: pointer;
      }
      
      .chat-teaser::after {
        content: '';
        position: absolute;
        right: -8px;
        bottom: 8px;
        width: 0;
        height: 0;
        border-left: 8px solid #1a1a1a;
        border-top: 6px solid transparent;
        border-bottom: 6px solid transparent;
      }
      
      .chat-teaser span {
        color: #00FF7F;
        font-weight: 600;
      }
      
      @keyframes teaserSlide {
        from { opacity: 0; transform: translateX(20px); }
        to { opacity: 1; transform: translateX(0); }
      }
      
      @keyframes teaserFloat {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-3px); }
      }
      
      
      .chat-popup {
        position: absolute;
        bottom: 80px;
        right: 0;
        width: 360px;
        max-height: calc(100vh - 150px);
        background: linear-gradient(180deg, #141414 0%, #0a0a0a 100%);
        border: 1px solid rgba(0, 255, 127, 0.2);
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6), 0 0 40px rgba(0, 255, 127, 0.1);
        opacity: 0;
        visibility: hidden;
        transform: translateY(20px) scale(0.95);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .chat-popup.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
      }
      
      .chat-header {
        background: linear-gradient(135deg, #00FF7F 0%, #00CC66 50%, #00AA55 100%);
        padding: 14px 16px;
        position: relative;
        overflow: hidden;
      }
      
      .chat-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23000000' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        opacity: 0.5;
      }
      
      .chat-header-content {
        position: relative;
        z-index: 1;
      }
      
      .chat-header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }
      
      .chat-brand {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      .chat-avatar {
        width: 36px;
        height: 36px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
      }
      
      .chat-brand-info h4 {
        margin: 0;
        font-size: 0.95rem;
        font-weight: 700;
        color: #000;
      }
      
      .chat-status {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 0.7rem;
        color: rgba(0, 0, 0, 0.7);
      }
      
      .status-dot {
        width: 6px;
        height: 6px;
        background: #000;
        border-radius: 50%;
        animation: statusPulse 1.5s infinite;
      }
      
      @keyframes statusPulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
      }
      
      .chat-close {
        width: 32px;
        height: 32px;
        background: rgba(0, 0, 0, 0.15);
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }
      
      .chat-close:hover {
        background: rgba(0, 0, 0, 0.25);
        transform: rotate(90deg);
      }
      
      .chat-close svg {
        width: 16px;
        height: 16px;
        stroke: #000;
      }
      
      .chat-response-time {
        background: rgba(0, 0, 0, 0.1);
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.7rem;
        color: rgba(0, 0, 0, 0.8);
        display: inline-flex;
        align-items: center;
        gap: 5px;
      }
      
      .chat-messages {
        padding: 16px;
        height: 220px;
        overflow-y: auto;
        background: linear-gradient(180deg, rgba(0,255,127,0.02) 0%, transparent 100%);
      }
      
      .chat-messages::-webkit-scrollbar {
        width: 4px;
      }
      
      .chat-messages::-webkit-scrollbar-track {
        background: transparent;
      }
      
      .chat-messages::-webkit-scrollbar-thumb {
        background: rgba(0, 255, 127, 0.3);
        border-radius: 2px;
      }
      
      .chat-message {
        display: flex;
        gap: 12px;
        margin-bottom: 16px;
        animation: messageSlide 0.4s ease;
      }
      
      @keyframes messageSlide {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      .chat-message-avatar {
        width: 36px;
        height: 36px;
        background: linear-gradient(135deg, #00FF7F 0%, #00CC66 100%);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        font-size: 0.9rem;
      }
      
      .chat-message-content {
        flex: 1;
      }
      
      .chat-message-bubble {
        background: linear-gradient(135deg, #1a1a1a 0%, #151515 100%);
        border: 1px solid rgba(255, 255, 255, 0.05);
        padding: 14px 16px;
        border-radius: 16px;
        border-top-left-radius: 4px;
        max-width: 90%;
      }
      
      .chat-message-bubble p {
        margin: 0;
        font-size: 0.9rem;
        color: #fff;
        line-height: 1.5;
      }
      
      .chat-message-time {
        font-size: 0.7rem;
        color: #555;
        margin-top: 6px;
        display: block;
      }
      
      .chat-quick-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 12px;
      }
      
      .quick-action-btn {
        background: rgba(0, 255, 127, 0.1);
        border: 1px solid rgba(0, 255, 127, 0.2);
        padding: 8px 14px;
        border-radius: 20px;
        font-size: 0.8rem;
        color: #00FF7F;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .quick-action-btn:hover {
        background: rgba(0, 255, 127, 0.2);
        transform: translateY(-2px);
      }
      
      .chat-input-area {
        padding: 16px 20px;
        background: #0d0d0d;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
      }
      
      .chat-input-wrapper {
        display: flex;
        gap: 10px;
        align-items: center;
        background: #1a1a1a;
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 14px;
        padding: 6px 6px 6px 16px;
        transition: all 0.3s ease;
      }
      
      .chat-input-wrapper:focus-within {
        border-color: rgba(0, 255, 127, 0.4);
        box-shadow: 0 0 20px rgba(0, 255, 127, 0.1);
      }
      
      .chat-input-wrapper input {
        flex: 1;
        background: transparent;
        border: none;
        color: #fff;
        font-size: 0.9rem;
        outline: none;
      }
      
      .chat-input-wrapper input::placeholder {
        color: #555;
      }
      
      .chat-send-btn {
        width: 42px;
        height: 42px;
        background: linear-gradient(135deg, #00FF7F 0%, #00CC66 100%);
        border: none;
        border-radius: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }
      
      .chat-send-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 15px rgba(0, 255, 127, 0.4);
      }
      
      .chat-send-btn:active {
        transform: scale(0.95);
      }
      
      .chat-send-btn svg {
        width: 20px;
        height: 20px;
        stroke: #000;
        fill: none;
      }
      
      .chat-footer {
        padding: 12px 20px;
        text-align: center;
        font-size: 0.7rem;
        color: #444;
        background: #0a0a0a;
      }
      
      .chat-footer a {
        color: #00FF7F;
        text-decoration: none;
      }
      
      @media (max-width: 480px) {
        .chat-widget {
          bottom: 15px;
          right: 15px;
        }
        .chat-popup {
          width: calc(100vw - 30px);
          right: -10px;
          bottom: 75px;
        }
        .chat-btn {
          width: 55px;
          height: 55px;
        }
        .chat-teaser {
          display: none;
        }
      }
    </style>
    
    <div class="chat-widget" id="maxlabs-chat-widget">
      <div class="chat-teaser" id="chat-teaser" onclick="toggleMaxLabsChat()">
        ðŸ‘‹ <span>Need help?</span> We're online!
      </div>
      <button class="chat-btn has-message" id="chat-toggle-btn" onclick="toggleMaxLabsChat()">
        <svg class="chat-icon" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
        </svg>
        <svg class="close-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      
      <div class="chat-popup" id="chat-popup-box">
        <div class="chat-header">
          <div class="chat-header-content">
            <div class="chat-header-top">
              <div class="chat-brand">
                <div class="chat-avatar">ðŸ’ª</div>
                <div class="chat-brand-info">
                  <h4>Max Labs Support</h4>
                  <div class="chat-status">
                    <span class="status-dot"></span>
                    <span>Online now</span>
                  </div>
                </div>
              </div>
              <button class="chat-close" onclick="toggleMaxLabsChat()">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>
            <div class="chat-response-time">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
              Usually replies in minutes
            </div>
          </div>
        </div>
        
        <div class="chat-messages" id="chat-messages">
          <div class="chat-message">
            <div class="chat-message-avatar">ðŸ§¬</div>
            <div class="chat-message-content">
              <div class="chat-message-bubble">
                <p>Hey there! ðŸ‘‹ Welcome to Max Labs. I'm here to help you find the perfect supplements for your goals.</p>
              </div>
              <span class="chat-message-time">Just now</span>
              <div class="chat-quick-actions">
                <button class="quick-action-btn" onclick="quickMessage('Product recommendations')">Product Recommendations</button>
                <button class="quick-action-btn" onclick="quickMessage('Shipping info')">Shipping Info</button>
                <button class="quick-action-btn" onclick="quickMessage('Track my order')">Track Order</button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="chat-input-area">
          <form onsubmit="sendMaxLabsMessage(event)">
            <div class="chat-input-wrapper">
              <input type="text" id="chat-input" placeholder="Type your message..." autocomplete="off">
              <button type="submit" class="chat-send-btn">
                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="22" y1="2" x2="11" y2="13"></line>
                  <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
              </button>
            </div>
          </form>
        </div>
        
        <div class="chat-footer">
          Powered by <a href="#">Max Labs</a> â€¢ We're here to help 24/7
        </div>
      </div>
    </div>
    
    <script>
      function toggleMaxLabsChat() {
        var popup = document.getElementById('chat-popup-box');
        var btn = document.getElementById('chat-toggle-btn');
        var teaser = document.getElementById('chat-teaser');
        
        popup.classList.toggle('active');
        btn.classList.toggle('active');
        
        // Hide teaser when chat is open, show when closed
        if (popup.classList.contains('active')) {
          if (teaser) teaser.style.display = 'none';
        } else {
          if (teaser) teaser.style.display = '';
        }
      }
      
      function quickMessage(msg) {
        document.getElementById('chat-input').value = msg;
        document.getElementById('chat-input').focus();
      }
      
      function sendMaxLabsMessage(e) {
        e.preventDefault();
        var input = document.getElementById('chat-input');
        var messages = document.getElementById('chat-messages');
        
        if (input.value.trim()) {
          // Add user message
          var userMsg = document.createElement('div');
          userMsg.className = 'chat-message';
          userMsg.style.flexDirection = 'row-reverse';
          userMsg.innerHTML = `
            <div class="chat-message-content" style="text-align: right;">
              <div class="chat-message-bubble" style="background: linear-gradient(135deg, #00FF7F 0%, #00CC66 100%); border-top-left-radius: 16px; border-top-right-radius: 4px; margin-left: auto;">
                <p style="color: #000;">${input.value}</p>
              </div>
              <span class="chat-message-time">Just now</span>
            </div>
          `;
          messages.appendChild(userMsg);
          messages.scrollTop = messages.scrollHeight;
          
          var userText = input.value;
          input.value = '';
          
          // Simulate typing indicator then response
          setTimeout(function() {
            var botMsg = document.createElement('div');
            botMsg.className = 'chat-message';
            botMsg.innerHTML = `
              <div class="chat-message-avatar">ðŸ§¬</div>
              <div class="chat-message-content">
                <div class="chat-message-bubble">
                  <p>Thanks for your message! Our team will get back to you shortly. In the meantime, feel free to browse our products or check our FAQ page.</p>
                </div>
                <span class="chat-message-time">Just now</span>
              </div>
            `;
            messages.appendChild(botMsg);
            messages.scrollTop = messages.scrollHeight;
          }, 1000);
        }
      }
    </script>
  {% endif %}

  <script>
    // Age Verification - Uses sessionStorage to persist for browser session only
    // This prevents the popup from appearing on every page navigation
    
    function confirmAge() {
      sessionStorage.setItem('maxlabs_age_verified', 'true');
      document.getElementById('ageModal').classList.remove('show');
    }

    function denyAge() {
      window.location.href = 'https://www.google.com';
    }

    // Check age verification on load - only show if not verified this session
    (function() {
      var isVerified = sessionStorage.getItem('maxlabs_age_verified');
      var modal = document.getElementById('ageModal');
      
      if (!isVerified) {
        // Not verified - show the modal
        modal.classList.add('show');
      }
      // If verified, modal stays hidden (default state)
    })();

    // Header scroll effect
    window.addEventListener('scroll', function() {
      const header = document.getElementById('siteHeader');
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    });

    // Mobile menu
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileNav = document.getElementById('mobileNav');
    const mobileNavClose = document.getElementById('mobileNavClose');

    mobileMenuToggle.addEventListener('click', function() {
      mobileNav.classList.add('active');
      document.body.style.overflow = 'hidden';
    });

    mobileNavClose.addEventListener('click', function() {
      mobileNav.classList.remove('active');
      document.body.style.overflow = '';
    });

    // Close mobile nav on link click
    mobileNav.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', function() {
        mobileNav.classList.remove('active');
        document.body.style.overflow = '';
      });
    });

  </script>

  <!-- Homepage Sticky Add to Cart Bar -->
  <div class="homepage-sticky-cart" id="homepageStickyCart">
    <div class="homepage-sticky-content">
      <div class="homepage-sticky-info">
        <img id="homepageStickyImage" src="" alt="">
        <div>
          <div class="homepage-sticky-name" id="homepageStickyName"></div>
          <div class="homepage-sticky-price" id="homepageStickyPrice"></div>
        </div>
      </div>
      <form method="post" id="homepageStickyForm" onsubmit="return false;">
        <input type="hidden" name="id" id="homepageStickyVariantId" value="">
        <div class="homepage-qty-selector">
          <button type="button" class="homepage-qty-btn" onclick="updateHomepageStickyQty(-1)">âˆ’</button>
          <input type="number" name="quantity" id="homepageStickyQty" value="1" min="1" max="10">
          <button type="button" class="homepage-qty-btn" onclick="updateHomepageStickyQty(1)">+</button>
        </div>
        <button type="submit" class="homepage-sticky-btn">Add</button>
      </form>
    </div>
  </div>
  
  <style>
    .homepage-sticky-cart {
      position: fixed;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(10, 10, 10, 0.98);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 255, 127, 0.3);
      border-radius: 50px;
      padding: 10px 25px;
      z-index: 990;
      transition: bottom 0.3s ease;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }
    .homepage-sticky-cart.visible {
      bottom: 25px;
    }
    .homepage-sticky-content {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .homepage-sticky-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .homepage-sticky-info img {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border-radius: 8px;
    }
    .homepage-sticky-name {
      font-weight: 600;
      color: #fff;
      font-size: 0.85rem;
      max-width: 150px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .homepage-sticky-price {
      color: var(--color-primary);
      font-weight: 700;
      font-size: 1rem;
    }
    #homepageStickyForm {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .homepage-sticky-btn {
      background: var(--color-primary);
      color: #000;
      border: none;
      padding: 12px 25px;
      border-radius: 50px;
      font-weight: 700;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .homepage-sticky-btn:hover {
      background: #00cc66;
    }
    .homepage-qty-selector {
      display: flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 25px;
      overflow: hidden;
    }
    .homepage-qty-btn {
      background: transparent;
      border: none;
      color: #fff;
      width: 32px;
      height: 32px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: background 0.2s;
    }
    .homepage-qty-btn:hover {
      background: rgba(0, 255, 127, 0.2);
    }
    .homepage-qty-selector input {
      width: 35px;
      text-align: center;
      background: transparent;
      border: none;
      color: #fff;
      font-size: 0.9rem;
      font-weight: 600;
      -moz-appearance: textfield;
    }
    .homepage-qty-selector input::-webkit-outer-spin-button,
    .homepage-qty-selector input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    @media (max-width: 768px) {
      .homepage-sticky-cart {
        left: 10px;
        right: 10px;
        transform: none;
        border-radius: 12px;
        padding: 10px 15px;
      }
      .homepage-sticky-cart.visible {
        bottom: 80px;
      }
      .homepage-sticky-name {
        display: none;
      }
    }
  </style>
  
  <script>
    // Homepage Sticky Quantity
    function updateHomepageStickyQty(change) {
      const input = document.getElementById('homepageStickyQty');
      let val = parseInt(input.value) + change;
      if (val < 1) val = 1;
      if (val > 10) val = 10;
      input.value = val;
    }
    
    // Homepage Sticky Cart - shows on hover
    (function() {
      let stickyTimeout;
      const stickyCart = document.getElementById('homepageStickyCart');
      
      if (!stickyCart) return;
      
      document.querySelectorAll('.homepage-product-card').forEach(card => {
        card.addEventListener('mouseenter', function() {
          clearTimeout(stickyTimeout);
          
          document.getElementById('homepageStickyName').textContent = this.dataset.productTitle;
          document.getElementById('homepageStickyPrice').textContent = this.dataset.productPrice;
          document.getElementById('homepageStickyImage').src = this.dataset.productImage;
          document.getElementById('homepageStickyVariantId').value = this.dataset.variantId;
          document.getElementById('homepageStickyQty').value = 1; // Reset quantity
          
          stickyCart.classList.add('visible');
        });
        
        card.addEventListener('mouseleave', function() {
          stickyTimeout = setTimeout(() => {
            stickyCart.classList.remove('visible');
          }, 2000);
        });
      });
      
      // Keep visible when hovering over the bar
      stickyCart.addEventListener('mouseenter', function() {
        clearTimeout(stickyTimeout);
      });
      
      stickyCart.addEventListener('mouseleave', function() {
        stickyTimeout = setTimeout(() => {
          this.classList.remove('visible');
        }, 1000);
      });
      
      // Handle add to cart
      const form = document.getElementById('homepageStickyForm');
      if (form) {
        form.onsubmit = async function(e) {
          e.preventDefault();
          
          const btn = this.querySelector('.homepage-sticky-btn');
          const originalText = btn.textContent;
          btn.textContent = 'Adding...';
          btn.disabled = true;
          
          const variantId = document.getElementById('homepageStickyVariantId').value;
          const quantityInput = document.getElementById('homepageStickyQty');
          const quantity = quantityInput ? parseInt(quantityInput.value) : 1;
          
          try {
            const res = await fetch('/cart/add.js', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ id: Number(variantId), quantity: quantity })
            });
            
            if (res.ok) {
              btn.textContent = 'Added âœ“';
              btn.style.background = '#00CC66';
              
              fetch('/cart.js').then(r => r.json()).then(cart => {
                document.querySelectorAll('.cart-count').forEach(el => {
                  el.textContent = cart.item_count;
                });
              });
              
              setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '';
                btn.disabled = false;
              }, 2000);
            } else {
              throw new Error('Failed');
            }
          } catch (err) {
            btn.textContent = 'Error';
            setTimeout(() => {
              btn.textContent = originalText;
              btn.style.background = '';
              btn.disabled = false;
            }, 2000);
          }
          
          return false;
        };
      }
    })();
  </script>

  <!-- Back to Top Button -->
  <button id="backToTop" class="back-to-top" aria-label="Back to top">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M18 15l-6-6-6 6"/>
    </svg>
  </button>
  <style>
    .back-to-top {
      position: fixed;
      bottom: 30px;
      right: 100px;
      width: 55px;
      height: 55px;
      background: #00FF7F;
      color: #000;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 99999;
      box-shadow: 0 4px 25px rgba(0, 255, 127, 0.5);
    }
    .back-to-top.visible {
      opacity: 1;
      visibility: visible;
    }
    .back-to-top:hover {
      transform: translateY(-3px) scale(1.1);
      box-shadow: 0 8px 30px rgba(0, 255, 127, 0.6);
    }
    @media (max-width: 768px) {
      .back-to-top {
        bottom: 20px;
        right: 80px;
        width: 50px;
        height: 50px;
      }
    }
  </style>
  <script>
    // Back to top button - shows when scrolled more than halfway down the page
    (function() {
      const backToTop = document.getElementById('backToTop');
      const chatTeaser = document.getElementById('chat-teaser');
      const chatPopup = document.getElementById('chat-popup-box');
      
      if (backToTop) {
        window.addEventListener('scroll', function() {
          // Get total scrollable height and show button when past halfway
          const scrollableHeight = document.documentElement.scrollHeight - window.innerHeight;
          const halfwayPoint = scrollableHeight / 2;
          
          if (window.scrollY > halfwayPoint && window.scrollY > 300) {
            backToTop.classList.add('visible');
            // Hide chat teaser when back-to-top is visible (unless chat is open)
            if (chatTeaser && (!chatPopup || !chatPopup.classList.contains('active'))) {
              chatTeaser.style.display = 'none';
            }
          } else {
            backToTop.classList.remove('visible');
            // Show chat teaser when back-to-top is hidden (unless chat is open)
            if (chatTeaser && (!chatPopup || !chatPopup.classList.contains('active'))) {
              chatTeaser.style.display = '';
            }
          }
        });
        backToTop.addEventListener('click', function() {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      }
    })();
  </script>
</body>
</html>
